<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Charger un fichier .log</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }

    #drop-zone {
      border: 2px dashed #aaa;
      padding: 40px;
      color: #555;
      margin: 30px auto;
      width: 400px;
      transition: background 0.3s;
      cursor: pointer;
    }

    #drop-zone.hover {
      background-color: #f0f0f0;
    }

    #file-input {
      display: none;
    }

    #log-content {
      white-space: pre-wrap;
      background: #f7f7f7;
      padding: 15px;
      border: 1px solid #ccc;
      max-height: 400px;
      overflow-y: auto;
      margin: 20px auto;
      width: 90%;
      text-align: left;
    }
  </style>
</head>
<body>

  <h2>Charger un fichier .log</h2>

  <div id="drop-zone">
    DÃ©posez votre fichier .log ici ou <label for="file-input" style="color:blue; text-decoration:underline; cursor:pointer;">cliquez ici</label>
  </div>
  <input type="file" id="file-input" accept=".log,.txt">

  <div id="log-content"></div>

  <script>
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('file-input');
    const logContent = document.getElementById('log-content');

    function handleFile(file) {
      const reader = new FileReader();
      reader.onload = function(event) {
        const lines = event.target.result.split('\n');
        const highlighted = lines.map(highlightLine).join('<br>');
        logContent.innerHTML = highlighted;
      };
      reader.readAsText(file);
    }

    function highlightLine(line) {
      const escaped = escapeHtml(line);

      if (/ERROR|ERR|Error/i.test(line)) {
        return `<span style="color:red; font-weight:bold;">${escaped}</span>`;
      }
      if (/WARNING|WARN/i.test(line)) {
        return `<span style="color:orange;">${escaped}</span>`;
      }
      if (/INFO|INF/i.test(line)) {
        return `<span style="color:green;">${escaped}</span>`;
      }
      if (/\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/.test(line)) {
        return `<span style="color:blue;">${escaped}</span>`;
      }
      return escaped;
    }

    function escapeHtml(text) {
      return text
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
    }

    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) handleFile(file);
    });

    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('hover');
    });

    dropZone.addEventListener('dragleave', () => {
      dropZone.classList.remove('hover');
    });

    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('hover');
      const file = e.dataTransfer.files[0];
      if (file) handleFile(file);
    });
  </script>

</body>
</html>
